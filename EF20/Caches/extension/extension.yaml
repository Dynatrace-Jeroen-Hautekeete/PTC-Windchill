name: custom:com.ptc.jmx.caches
version: 2.0.0
minDynatraceVersion: 1.275.0
author:
  name: Jeroen Hautekeete
jmx:
  groups:
    - group: jmx
      subgroups:
        - subgroup: com.ptc:name=*,wt.monitorType=Caches,wt.subsystem=Monitors,*
          query: com.ptc:name=*,wt.monitorType=Caches,wt.subsystem=Monitors,*
          metrics:
            - key: com.ptc.jmx.caches.metric_CacheSize
              value: attribute:CacheSize
              type: gauge
            - key: com.ptc.jmx.caches.metric_CacheEntryCount
              value: attribute:CacheEntryCount
              type: gauge
          dimensions:
            - key: name
              value: property:name
screens:
  - entityType: HOST
    detailsInjections:
      - type: METRIC_TABLE
        key: metrictable-jmx-ptc_caches
        conditions:
          - metricAvailable|metric=dsfm:extension.status:filter(and(eq("dt.extension.name","custom:com.ptc.jmx.caches"),in("dt.entity.host",
            entitySelector("entityId($(entityId))"))))|lastWrittenWithinDays=5
    metricTableCards:
      - key: metrictable-jmx-ptc_caches
        displayName: PTC Caches (com.ptc.jmx.caches)
        pageSize: 5
        numberOfVisibleCharts: 2
        hideEmptyCharts: true
        displayCharts: true
        enableDetailsExpandability: true
        charts:
          - displayName: Cache Size
            visualizationType: GRAPH_CHART
            graphChartConfig:
              stacked: false
              metrics:
                - metricSelector: com.ptc.jmx.caches.metric_CacheSize:splitBy()
                  metricSelectorSort: com.ptc.jmx.caches.metric_CacheSize$(entityFilter)$(userFilter):splitBy("dt.entity.process_group_instance"):avg$(aggregation):last:sort(value(avg,$(sortOrder))):names
                  metricSelectorDetailed: com.ptc.jmx.caches.metric_CacheSize$(entityFilter)$(userFilter):splitBy("dt.entity.process_group_instance")$(aggregation)
                  visualization:
                    displayName: Cache Size
          - displayName: Cache Entry Count
            visualizationType: GRAPH_CHART
            graphChartConfig:
              stacked: false
              metrics:
                - metricSelector: com.ptc.jmx.caches.metric_CacheEntryCount:splitBy()
                  metricSelectorSort: com.ptc.jmx.caches.metric_CacheEntryCount$(entityFilter)$(userFilter):splitBy("dt.entity.process_group_instance"):avg$(aggregation):last:sort(value(avg,$(sortOrder))):names
                  metricSelectorDetailed: com.ptc.jmx.caches.metric_CacheEntryCount$(entityFilter)$(userFilter):splitBy("dt.entity.process_group_instance")$(aggregation)
                  visualization:
                    displayName: Cache Entry Count
metrics:
  - key: com.ptc.jmx.caches.metric_CacheSize
    metadata:
      displayName: PTC Cache Size
      description: PTC Cache Size
      unit: Count
      sourceEntityType: process_group_instance
      tags:
        - JMX
  - key: com.ptc.jmx.caches.metric_CacheEntryCount
    metadata:
      displayName: PTC Cache Entry Count
      description: PTC Cache Entry Count
      unit: Count
      sourceEntityType: process_group_instance
      tags:
        - JMX
